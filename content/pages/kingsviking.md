title: 王様達のヴァイキング、監修の裏側
icon: fa-code
navtitle: kingsviking
slug: kingsviking
socialbuttons: yes


ここでは、[王様達のヴァイキング]について、本編のストーリーとは関係しない設定の舞台裏（主に技術面）についてまとめていきたいと思います。
公式アカウント [@kingsviking] で言及するにはふさわしくない、ましてや、単行本の巻末記事にさえもとても書けないような、本当にどうでもいい部分ばかりを意図的に取り上げていますので、お気楽に読んでくださいね。:)

なお、ネタバレを含んでいるかもしれないですので、まだ単行本を読んでいない人は、見ないほうがいいです。

私が技術監修としてこの作品に関わっている部分は主に以下の部分です。

- 漫画家のさだやすさん、ストーリー協力の[深見さん](http://ja.wikipedia.org/wiki/%E6%B7%B1%E8%A6%8B%E7%9C%9F)・担当編集の山内さんたちと一緒に全体のストーリーの構成を技術面からサポート。ストーリーの技術的詳細を詰める。
- 是枝くんをはじめとする登場人物たちの具体的なエンジニアリング・ハッキング部分についての技術監修。
- 漫画に登場するソースコードやその他のエンジニアリング的素材（登場人物の開発環境など）の作成。

[王様達のヴァイキング]: http://www.spi-shogakukan.com/viking/
[@kingsviking]: http://twitter.com/kingsviking


つまり、一般の読者からは「わからないです！」と言われ、詳しい人からは「いや、この設定、気にいらない」と、石を投げられる側の役割です...。
なお、技術的正確さと漫画としての面白さが衝突しそうなときは、漫画としての面白さを常に優先するということで、スタッフの意見は一致しています！

気がついたり、思い出したところは、どんどん追記していきます。あたらしい単行本が発売されたときもに忘れないうちに追加しますね。

最終更新: [2014/05/27]


---


王様達のヴァイキング第5巻 (発売日未定)
====

CODE 7:GUESS WHO'S COMING TO DINNER (招かれざる客)
-----

- 5巻発売後、書く予定です。:)

---


[王様達のヴァイキング第4巻] (2014-06-12 発売予定)
====

[王様達のヴァイキング第4巻]: http://www.amazon.co.jp/%E7%8E%8B%E6%A7%98%E9%81%94%E3%81%AE%E3%83%B4%E3%82%A1%E3%82%A4%E3%82%AD%E3%83%B3%E3%82%B0-4-%E3%83%93%E3%83%83%E3%82%B0-%E3%82%B3%E3%83%9F%E3%83%83%E3%82%AF%E3%82%B9-%E3%81%95%E3%81%A0%E3%82%84%E3%81%99/dp/4091862047/

![王様達のヴァイキング第4巻](http://ecx.images-amazon.com/images/I/61sTv%2B0qpWL._SL1000_AA600_.jpg)


CODE 6:Conversation Piece (家族の肖像)
-----

- 4巻発売後、書く予定です。:)


---

[王様達のヴァイキング第3巻] (2014-01-30 発売)
====

[王様達のヴァイキング第3巻]: http://www.amazon.co.jp/%E7%8E%8B%E6%A7%98%E9%81%94%E3%81%AE%E3%83%B4%E3%82%A1%E3%82%A4%E3%82%AD%E3%83%B3%E3%82%B0-3-%E3%83%93%E3%83%83%E3%82%B0%E3%82%B3%E3%83%9F%E3%83%83%E3%82%AF%E3%82%B9-%E3%81%95%E3%81%A0%E3%82%84%E3%81%99/dp/4091858457/

![王様達のヴァイキング第3巻](http://ecx.images-amazon.com/images/I/61ZjH209bUL._SL1000_AA600_.jpg)

CODE 4:MACK THE KNIFE (三文オペラ) [後半]
-----

-   12ページ: [Nmap] のバージョンは 5.21.zer0 です（是枝くん専用に独自にビルドしました）。

-   13ページ: `pstree` の結果です。apache のプロセスが schrodinger プロセスを fork しまくっているところです。

-   13ページ: どうやって侵入したかの私の頭の中の設定です。あまり気にしないようにね☆ 漫画上ではこの部分に関する説明は是枝くんのセリフ1つだけですませてますので...。:)

    1. リクエストに含まれるリクエストパラメータを保持するために、Webサーバが使用するハッシュテーブル、そこで使用されているハッシュ関数はとても単純で公開されている。

    2. なので、攻撃者は事前にハッシュ値が同じになるような文字列を準備しておくことが可能。

    3. そのような文字列からなるリクエストパラメータを大量にWebサーバに送ることによって、Webサーバ内部がリクエストを前処理する部分で、大量のハッシュの衝突が起きる。一種のDoS状態を引き起こせる。

    4. なので、最近のWebサーバは、リクエストパラメータの数を制限したり、randomized hash関数を使っていたりする。

    5. この場合は、事前に、攻撃者がハッシュ値が同じになるような文字列を準備しておくことは事実上不可能。

    6. randomized hash関数に使用されている seed は外部からは一般に観測も予測も不可能。

    7. しかし、そこはさすがの笑い猫さん。ハッシュテーブルからキーが取り出されるときの順序などから、*観測*をある程度行うことによって、seedの予測・特定がある程度確率的に可能であることを独自に発見。

    8. 笑い猫さん、攻撃対象であるWebサーバに対して、これらを自動的に行い、ハッシュテーブル内部で使用されている各種seedを予測するプログラムを書く。

    9. この処理は、対象のWebサーバのインスタンスごと、かつある程度の観測が必要なので、ある程度時間がかかる。

    10. 一般には、DoS状態になっても、特権状態は奪取できないのですが、そこは、さすがの笑い猫さん。なぜか、Dos状態のリクエストキューイング処理に問題があることを知っていて、そこを突く。特権奪取。

    是枝くんが行ったことは、

    1. シュレディンガーが行ったこれら一連の処理をリバースエンジニアリングした

    2. 処理の高速化（少ない観測数で済むように）

    です。

    どうして、シュレディンガーにこれらの処理が残っていたかについては、... (∩ﾟдﾟ)ｱｰｱｰきこえなーい。


-   14ページ: 是枝くんは [Emacs] 使いです。Emacs を上下に2分割しています。

    -   上部: 監視用 Python スクリプト、`watchdog256.py`。是枝くんは、付ける名前に困ったら、とりあえず、 `256` を最後につけます。

    -   下部: 是枝くんが、反撃用の `schrodinger256` をビルドしているところです。

        ソースコードは C++で書いていて (`schrodinger256.cc`)、ビルドは `Make` ではなく、[waf] を使用しています。
  `gcc` ではなく `clang` です。

        ビルド終了後、 `netcat -e` で 相手サーバの80番と、`schrodinger256` の I/O を結びつけています。

-   16ページ: 最初は、坂井ビルの Wifi は WEP を使っているため（古いNintendo DS が残っている)、WEP の脆弱性を突く予定でしたが、結局、ルーターに書いてあるパスワードの写真をとるという原始的方法になりました。わかりやすい。

-   17ページ: 笑い猫の使用しているラップトップは、Dell の [Alienware] です。
    是枝くんの ThinkPad が比較的小さいのと対照的に、大きなラップトップを持ち歩いています。

-   24ページ: 笑い猫は、シュレディンガーが簡単に解析されないように、独自リンカでリンクしているという設定です。
    リンカを最後までつくったことのある人とか、きっと、世界には20人くらいしかいない気がする..。

-   33ページ: 六本木にある [awabar](http://tabelog.com/tokyo/A1307/A130701/13120025/) です。

-   44ページ: ハードディスクは、USBだけではパワー不足なので、ちゃんと電源ケーブルをつなげています。

-   46ページ: チャット画面は、単行本で差し替えられています。スピリッツ連載時は、Google Chrome / Blink の 開発者がいる IRC チャット `#blink` の様子でした。
    ごめんなさい。:)

-   47ページ: 「イチかバチかなんて...」のセリフでばれちゃう原田くんでしたが、最初は、かわいい特徴的な顔文字を使うのでばれるというのが、僕の案でした。
    原田くんにかわいい顔文字使ってほしかった...。(・∀・)。∩(\*・∀・\*)∩ﾌｧｲﾄ♪

-   79ページ: 笑い猫 (LaughingCat) という名前はここまでなかなか明かされませんでした。攻殻機動隊の [笑い男] を意識しています。
    それに、[猫] 飼っていますしね。
    世間では、彼は、「シュレディンガー」、「シュレちゃん」、「変態くん」、「猫さん」、「変態猫」と呼ばれていますが、
    *本名* はいまだに明らかになっていないです。

-   90ページ: 「010101110」は *イメージ* です。バイナリは実際には「0-9A-F」で表現するほうが多いですけど、「ゼロ」と「イチ」だけ表現したほうが、
    読者にわかりやすいということで。もはや、笑い猫と是枝くんの、テーマ <strike>ソング</strike> 背景。:)

[Emacs]: http://ja.wikipedia.org/wiki/Emacs
[Nmap]: http://nmap.org/
[waf]:  https://code.google.com/p/waf/
[Alienware]: http://www.alienware.com/
[笑い男]: http://ja.wikipedia.org/wiki/%E7%AC%91%E3%81%84%E7%94%B7_(%E6%94%BB%E6%AE%BB%E6%A9%9F%E5%8B%95%E9%9A%8A)
[メルセンヌ・ツイスタ]: http://ja.wikipedia.org/wiki/%E3%83%A1%E3%83%AB%E3%82%BB%E3%83%B3%E3%83%8C%E3%83%BB%E3%83%84%E3%82%A4%E3%82%B9%E3%82%BF
[猫]: http://ja.wikipedia.org/wiki/%E3%82%B7%E3%83%A5%E3%83%AC%E3%83%BC%E3%83%87%E3%82%A3%E3%83%B3%E3%82%AC%E3%83%BC%E3%81%AE%E7%8C%AB

CODE 5:THE BUCKET LIST (最高の人生の見つけ方)
-------

-   104ページ: 坂井さんの講演がはじまって間もないのに、いきなり参加者が手を上げて「質問よろしいですか」と質問をはじめるのは、冷静に考えたらおかしい...。

-   113ページ: 1コマ目の自作PC、上下が逆なんですけど、まあ、2コマ目では、横たわっているので、「セーフ」ということで。

-   昴くんは 劇団ひとりさんとは 何の関係もありません。

---


[王様達のヴァイキング第2巻] (2013-09-30 発売)
====

[王様達のヴァイキング第2巻]: http://www.amazon.co.jp/%E7%8E%8B%E6%A7%98%E9%81%94%E3%81%AE%E3%83%B4%E3%82%A1%E3%82%A4%E3%82%AD%E3%83%B3%E3%82%B0-2-%E3%83%93%E3%83%83%E3%82%B0%E3%82%B3%E3%83%9F%E3%83%83%E3%82%AF%E3%82%B9-%E3%81%95%E3%81%A0%E3%82%84%E3%81%99/dp/4091854141/

![王様達のヴァイキング第2巻](http://ecx.images-amazon.com/images/I/61BVvCx8MoL._SL1000_AA600_.jpg)

各章のサブタイトル
-------


既にお気づきの方がいるかもしれませんが、「王様達のヴァイキング」の各章はサブタイトルがついています。

- CODE 0: 「GOD AND MONSTER」(坂井と是枝の出会い編)
- CODE 1: 「ANALYZE THIS」 (雷おこし(?)編)
- CODE 2: 「THINGS TO COME」 (ゲーム会社救出編）
- CODE 3: 「TWO FOR THE ROAD」（パスクラック編
- CODE 4: 「MACK THE KNIFE」（無差別サイバー攻撃編）

このタイトルが何からつけられているかは、...わかりますよね？？ :)


Code 3:Two For The Road (いつも２人で)
-------

- 6ページ: ストリート・コンピューティング (<https://twitter.com/suztomo/status/384677603975520256/photo/1>) はネタではなく実話にもとづいています。

- 11ページ: 是枝くんが初めて食べた牛たんは、仙台牛です。

- 13ページ: 是枝くんの自作ツールは、/home/zer0/src/passcrack ディレクトリにはいっています。いったん、make してます。

- 16ページ: 256 が雨の中、着ていたのは、是枝くんが２年生のときに使用していた体操着です。

- 34ページ: パスワードのリストは、パスワードのエントロピーの順番に並んでいます。(参考: <https://dl.dropboxusercontent.com/u/209/zxcvbn/test/index.html>)
そのうちの２つ「Tr0ub4dor&3」 と 「correcthorsebatterystaple」 には元ネタがあります。 （--> <http://xkcd.com/936/> ）

- 55ページ: 情報数理研究所の稲沢先生には元ネタがあります。 (-> 自粛)

- 60ページ: 坂井が是枝くんからの電話をエレベーター内で受けるシーンは、Apple の「エレベーターで昇降する間に仕事の内容を話せない奴は首だ」という逸話のちょっとしたオマージュです。スピード感があって、僕の好きなシーンのひとつです。数式の表記として `*`, `/` と  `x`, `÷` どちらを使うべきかという議論がありました。一般読者には `*`, `/` の表記に馴染みがない可能性があるので。

- 78ページ:  スパコンは、IBM の [PowerPC] ベースのスパコンです。是枝くんは、基本C++で書きつつ、コンパイラがうまく最適化してくれない部分については、Power の アセンプラを直接書いてカリカリにチューニングしたという設定です。


[PowerPC]: http://en.wikipedia.org/wiki/PowerPC


Code 4:Mack the Knife (三文オペラ) [前半]
--------

- 99ページ: 是枝くんが道路に書いた図は、マインド・マップを意識しています。

- 127ページ: 是枝くんが工場で Windowsのパッチをつくりましたが、あれは相当の変態技です。是枝くんは、Windows のソースコードなしで、Linux上で、Windows のパッチを作ったという設定です。是枝くんは、Windows の実行ファイルを Linux 上で動かすローダを、昔、趣味で書いたことがあって、その経験が生きたという設定です。

- 137-138ページ:「#maxwellsdemon」 と 「#laplacesdemon」は、犯人たちが連絡をとるのに使用していた、IRC のチャネル名です。物理学上有名な仮想の生物「マクスウェルの悪魔」と「ラプラスの悪魔」の手のひらの上で、 [NP困難] な問題たち （ @sat [充足可能性問題], @tsp [巡回セールスマン問題]、 @knapsack [ナップサップ問題], @chromatic [グラフの彩色] [Chromatic Nubmer] ）が踊っているという遊びごころです。

- 142ページ: ウイルスに名前をつけたほうがいいということで、ウイルスには最初「ルシファー（仮）」という適当な名前をつけていたんですけど、僕が「猫の名前からつけるんだったら、絶対シュレディンガーがいいです！猫といえばシュレディンガー！！！」ということで、シュレディンガーになりました。いまでは、なぜか、犯人も「シュレ」ちゃんと呼ばれるようになってしまいましたが..。シュレディンガーは、大部分が C++ で書かれています。シュレディンガーの特徴については、このあとの第3集でもう少し触れられます。シュレディンガーは、「あの是枝くんが「らんらん☆」する」のを意識して、デザインしました。

-   146ページ: 背景にある

    >       '01110011 01100011 01101000 01110010 01101111 01100100 01101001 01101110 01100111 01100101 01110010'

    の文字列はちゃんと意味があります。読んでみてくださいね。

- 180ページ: 256 が坂井ビルに登場したのは、「最近、256 が登場していないので、256 が心配です！256 だしてください！是枝くんと256が寄り添って寝ていたらとてもいいと思います！」とお願いしたら、さだやすさんがいっぱい出してくれました。とても癒される。

- 182ページ: 犯行声明の元ネタ動画です: [国際的ハッカー集団「アノニマス」がメキシコの麻薬組織に宣戦布告](http://www.youtube.com/watch?v=EMFnlE1bp_M)

- 188ページ:「deadbeef」は有名な 「16進数で表現できる言葉」のうちのひとつです。 参考) <http://en.wikipedia.org/wiki/Hexspeak>

- 193ページ: サーバがロシアにあるおかげで、「朝海（仮）はロシア人ハッカー」と思われているらしいですけど、サーバがロシアにあるだけで、本人がそこに住んでいるとは限らないです。確かに見た目、ロシア人っぽいけど。サーバは最初、Amazon の AWS の EC2 (シンガポール)にしようと思ったんですけど、クラウドは別の機会のネタに使えるということで、やはりここでも見送り。



[NP困難]: http://ja.wikipedia.org/wiki/NP%E5%9B%B0%E9%9B%A3
[充足可能性問題]: http://ja.wikipedia.org/wiki/%E5%85%85%E8%B6%B3%E5%8F%AF%E8%83%BD%E6%80%A7%E5%95%8F%E9%A1%8C
[巡回セールスマン問題]: http://ja.wikipedia.org/wiki/%E5%B7%A1%E5%9B%9E%E3%82%BB%E3%83%BC%E3%83%AB%E3%82%B9%E3%83%9E%E3%83%B3%E5%95%8F%E9%A1%8C
[ナップサック問題]: http://ja.wikipedia.org/wiki/%E3%83%8A%E3%83%83%E3%83%97%E3%82%B5%E3%83%83%E3%82%AF%E5%95%8F%E9%A1%8C
[グラフ彩色]: http://ja.wikipedia.org/wiki/%E3%82%B0%E3%83%A9%E3%83%95%E5%BD%A9%E8%89%B2
[Chromatic Number]: http://mathworld.wolfram.com/ChromaticNumber.html



---

[王様達のヴァイキング第1巻] (2013-06-28 発売)
====

[王様達のヴァイキング第1巻]: http://www.amazon.co.jp/%E7%8E%8B%E6%A7%98%E9%81%94%E3%81%AE%E3%83%B4%E3%82%A1%E3%82%A4%E3%82%AD%E3%83%B3%E3%82%B0-1-%E3%83%93%E3%83%83%E3%82%B0%E3%82%B3%E3%83%9F%E3%83%83%E3%82%AF%E3%82%B9-%E3%81%95%E3%81%A0%E3%82%84%E3%81%99/dp/4091853293

![王様達のヴァイキング第1巻](http://ecx.images-amazon.com/images/I/51AHhWw7tlL._SL1000_AA600_.jpg)

- Todo
