<!DOCTYPE html>
<html>
  <head>
    <title>Googleの面接試験で出る （はずがない）「海賊と金貨」問題を空気を読まないでプログラムで解いてみる — hayato.io</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">

    <link href="https://plus.google.com/+HayatoIto/posts" rel="author">

    <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet">

    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet">
    <link href="http://hayato.io/theme/solarizedlight.css" rel="stylesheet">
    <link href="http://hayato.io/theme/site.css" rel="stylesheet">

    <link id="favicon" href="http://hayato.io/static/timer/chocolate.ico" rel="shortcut icon">

    <link href="http://hayato.io/feeds/all.atom.xml" rel="alternate"
          title="All posts – hayato.io" type="application/atom+xml">

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-195971-6', 'hayato.io');
  ga('send', 'pageview');
</script>


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <nav class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="fa fa-collapse icon-2x"></span>
          </button>
          <a href="http://hayato.io/" class="navbar-brand">hayato.io</a>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li><a href="http://hayato.io/archives/"><i class="fa fa-list"></i>&nbsp;Archives</a></li>
            <li>
              <a href="http://hayato.io/about/"><i class="fa fa-user"></i>&nbsp;About</a>
            </li>
            <li>
              <a href="http://hayato.io/kingsviking/"><i class="fa fa-code"></i>&nbsp;kingsviking</a>
            </li>
            <li>
              <a href="http://hayato.io/timer/"><i class="fa fa-clock-o"></i>&nbsp;Timer</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div class="container">
      <div class="row">
        <div class="col-md-offset-1 col-md-10">

<article>
  <header class="page-header">
    <h1 class="site-article-title">
         Googleの面接試験で出る （はずがない）「海賊と金貨」問題を空気を読まないでプログラムで解いてみる
    </h1>
    <div class="post-date">
      <time datetime="2014-01-05">
        2014-01-05
      </time>
    </div>
  </header>
  <div class="article-content">
    <p>2014年お正月。とある小学生に:</p>
<p>小学生A: 「ねー、Google の面接試験で出るらしいこの問題、どうやって解くの？」</p>
<p>と聞かれました。</p>
<p>私: 「ほうほう、どんな問題？（あー、どうせまた "スクールバスにゴルフボールは何個入るでしょうか？" 的な問題かな。
そんな問題実際出るわけないんだけどなー。最近、よく出すのは "ゴルフボールにスクールバスを入れる方法" だからな！）」</p>
<p>と、軽くかわそうと思いきや、小学生A から出されたのは以下の問題でした。「海賊と金貨」問題と呼ばれているらしいです。</p>
<blockquote>
<p>17.</p>
<p>5人の海賊がいて、彼らは1位から5位にまでランク分けされています。1位の海賊は100枚の金貨をどのように分けるかというプランを提案する権利があります。残りの海賊はこのプランに投票する権利があり、賛成が半分に満たない場合には1位の海賊は殺されます。1位の海賊の分け前を最大にしてなおかつ彼が生き残るにはどうすればいいですか？（ヒント：一人の海賊は結局、金貨の98％で終わる）</p>
<p><cite>出典: <a href="http://gigazine.net/news/20070909_google_job_interview/">Googleの面接試験、一体どのような質問をされるのか？</a></cite></p>
</blockquote>
<p>私:「意外にまともな問題だった。」</p>
<p>小学生A:「ねー教えて。答えって本当にあるの？」</p>
<p>小学生N:「ずっと考えていたんだけど、わかんなかったの。正月に聞こうと思ってた（わくわく）」</p>
<p>私: 「も、もちろん、解けるよー。ちょっと待ってなー。」</p>
<hr />
<p>「大人なんだから、当然解けるよね？」的な眼差しで見つめられては、答えないわけにはいきません。
さて...。問題の設定が若干曖昧なので、まずは設定を補完しましょう。</p>
<ul>
<li>投票には、プランを提案する本人も含めて全員参加します。</li>
<li>投票の結果、賛成票が投票数の半数に満たなければ、プランの提案者はその場で殺されてしまいます。</li>
<li>ランク1位の海賊が殺されたら、次は残された4人で同じことを繰り返します。次にプランを提案するのは、ランク2位の海賊です。</li>
<li>賛成票が半数以上になって分け前が決定するまで、この手続きは繰り返されます。</li>
</ul>
<p>具体例です。最初に、ランク1位の海賊が「おれと海賊3は50枚ずつ。他のひとにはあげないよ」というプランを提案するとします。</p>
<p><img alt="pirates1" src="/static/2014/pirates1.png" /></p>
<p>それぞれプランに投票します。</p>
<p><img alt="pirates2" src="/static/2014/pirates2.png" /></p>
<p>賛成票は2票。5人の半数以上である3票に満たなかったので、プランを提案した人は殺されてしまいます。</p>
<p>残された4人で同じことを行います。次に提案する権利があるのは、ランク2位の海賊です。</p>
<p><img alt="pirates3" src="/static/2014/pirates3.png" /></p>
<p><img alt="pirates4" src="/static/2014/pirates4.png" /></p>
<p>今度も賛成票は2票ですが、今回は4人の半数以上である２票ですので、プランは採用され、分け前が決定されます。</p>
<p><img alt="pirates5" src="/static/2014/pirates5.png" /></p>
<p>結果は、<i class="fa fa-user"></i>海賊1 は死亡。<i class="fa fa-user"></i>海賊2は金貨70枚、<i class="fa fa-user"></i>海賊5は金貨30枚。<i class="fa fa-user"></i>海賊3と<i class="fa fa-user"></i>海賊4 は金貨0枚ですが、幸いなことに命だけは助かっています。</p>
<p>さらに必要な設定として、それぞれの海賊は、以下のルールに従って行動するとします。</p>
<ol>
<li>自分が生存することを最優先します。</li>
<li>生存できる場合は、得られる金貨の枚数を最大限にしようとします。</li>
<li>プランに賛成しても反対しても、自分が得られる金貨の枚数が結局同じになるならば、プランに反対します。</li>
<li>プランを提案するとき、採用されるプランが複数あるとします。その際、自分が得られる金貨の枚数が同じであるプランが複数あるならば、できるだけランクが下位の海賊に金貨を多く分配するプランを選択します。つまり、他の条件が同じであるかぎり、ランク4位の海賊よりもランク5位の海賊に多く金貨が渡るようなプランを提案します。</li>
</ol>
<p>つまり、海賊は</p>
<blockquote>
<p>(自分の命) &gt;&gt;&gt; [超えられない壁] &gt;&gt;&gt; (金貨) &gt;&gt;&gt; [超えられない壁] &gt;&gt;&gt; (ランクが上の海賊の不幸は蜜の味)</p>
</blockquote>
<p>という価値観に基いて行動します。...嫌なやつ。
海賊は、自分以外の他の海賊も同様に「嫌なやつ」であるということを、お互いに知っています。</p>
<hr />
<p>私: 「これは、あれだね。帰納法的に考えればいいんだね。」</p>
<p>小学生A: 「キノーホー？」</p>
<p>私: 「（うっ...）つまり、まず海賊がひとりだけだった場合を考えてみると。
この場合は、自分が金貨100枚ぜんぶゲットして終了。次に海賊が2人の場合を考えてみると、自分が賛成票をいれれば相手が反対しても、賛成半数とれるから、自分100枚・相手0枚の <code>[100, 0]</code> のプランで。次に海賊が3人の場合を考えてみると、えーと、必要な票数は2票だから、自分以外から1票取得できればいいわけで...。２人になったら、最後の人は一枚ももらえないから、最後の人に1枚だけあげれば、0枚よりはましだから、賛成してくれるはず。つまり、<code>[99, 0, 1]</code> のプランで賛成2票とれる。次に4人の場合は....」</p>
<p>小学生A: 「.... 」</p>
<p>...</p>
<p>私: 「... で、最後は、こうなるから、<code>[98, 0, 1, 0, 1]</code> のプランがベストだね。ランク1位の海賊は <code>98</code> 枚とれるな。」</p>
<p>小学生A: 「....わかんないよ。ほんと？ 」</p>
<p>私: 「うん、論理的に考えたら、そうなるはずだよ。」</p>
<p>小学生A: 「ロンリテキ？たった1枚しかもらえないのに賛成するかなー？信じられないなー。」</p>
<p>小学生N: 「うん。1枚はちょっと少ない気がする。」</p>
<p>小学生A: 「98枚とか言ってきたら私絶対反対する！自己中すぎる！」</p>
<p>小学生N: 「うん。98枚っていえちゃうところがすごいよね。すごい自信。」</p>
<p>小学生A: 「私だったら少なくとも33枚もらわないと、イヤっていっちゃうかな。」</p>
<p>小学生N: 「えー。私は20枚でおっけーだよ。」</p>
<p>私: 「（きみたち、ぼくの話なんにもきいてないだろ）... 証明したる。」</p>
<hr />
<p>もともとこの問題の意図するところは、頭の中だけで考えて答えを導き出すことだと思われます。
しかし、ここは <strike>生意気な</strike> 好奇心あふれる小学生たちに大人力を見せつけたいところです。</p>
<p>プログラミングの出番です。方針は簡単、可能なプランを全て生成します。そのなかから、ルールを満たす「ベスト」なプランをプログラムに選択させてみて、結果が頭の中で考えた結果と一致するかどうか確認してみることにしましょう。</p>
<p>例えば、海賊が1人の場合は、可能なプランは <code>[100]</code> とひとつだけです。</p>
<p>海賊が2人の場合は、可能なプランは以下の101通りになります。</p>
<ul>
<li><code>[0, 100]</code></li>
<li><code>[1, 99]</code></li>
<li><code>[2, 98]</code></li>
<li><code>[3, 97]</code></li>
<li>...</li>
<li><code>[99, 1]</code></li>
<li><code>[100, 0]</code></li>
</ul>
<p>このうち、プランの提案者にとってもっとも有利なものは、自分が100枚取得できる <code>[100, 0]</code> です。プログラムは、海賊が二人の場合は、<code>[100, 0]</code> を選択するはずです。</p>
<p>次に海賊が三人の場合は、可能なプランはぐっと増えます <sup id="fnref:1"><a class="footnote-ref" href="#fn:1" rel="footnote">1</a></sup>。</p>
<ul>
<li><code>[0, 0, 100]</code></li>
<li><code>[0, 1, 99]</code></li>
<li><code>[1, 0, 99]</code></li>
<li><code>[0, 2, 98]</code></li>
<li><code>[1, 1, 98]</code></li>
<li><code>[2, 0, 98]</code></li>
<li>...</li>
<li><code>[99, 0, 1]</code></li>
<li>...</li>
<li><code>[98, 2, 0]</code></li>
<li><code>[99, 1, 0]</code></li>
<li><code>[100, 0, 0]</code></li>
</ul>
<p>このプランの中から、賛成票を2票取得できるもののうち、一番よいプランは、<code>[99, 0, 1]</code> になるはずです。プログラムがそれを選択してくれることを祈りましょう。以下、同様に、海賊の数が5人の場合まで繰り返します。</p>
<p>では、実際にやってみましょう。ここでは、Python を使用します。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#!/usr/bin/env python3</span>

<span class="kn">import</span> <span class="nn">sys</span>


<span class="k">def</span> <span class="nf">generate_proposal</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">coin</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">member</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">yield</span> <span class="p">[</span><span class="n">coin</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">coin</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">proposal</span> <span class="ow">in</span> <span class="n">generate_proposal</span><span class="p">(</span><span class="n">member</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">coin</span> <span class="o">-</span> <span class="n">i</span><span class="p">):</span>
                <span class="k">yield</span> <span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">proposal</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">num_pirates</span><span class="p">,</span> <span class="n">coin</span><span class="p">):</span>

    <span class="n">optimal_proposal</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_pirates</span><span class="p">):</span>
        <span class="n">best_coin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">best_proposal</span> <span class="o">=</span> <span class="k">None</span>
        <span class="n">optimal_proposal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">proposal</span> <span class="ow">in</span> <span class="n">generate_proposal</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">coin</span><span class="p">):</span>
            <span class="n">vote</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">member</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">proposal</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">optimal_proposal</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">vote</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">member</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">proposal</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">best_coin</span><span class="p">:</span>
                <span class="n">best_coin</span> <span class="o">=</span> <span class="n">proposal</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">best_proposal</span> <span class="o">=</span> <span class="n">proposal</span>

        <span class="k">if</span> <span class="n">best_proposal</span><span class="p">:</span>
            <span class="n">optimal_proposal</span> <span class="o">=</span> <span class="n">best_proposal</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">member</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">optimal_proposal</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</td></tr></table>

<p>実行します。海賊が5人,金貨が100枚の場合は以下のようになります。</p>
<div class="highlight"><pre><span class="c">% ./pirates.py 5 100</span>
<span class="mi">1</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span>
<span class="mi">2</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="mi">3</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">99</span><span class="p">]</span>
<span class="mi">4</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">99</span><span class="p">]</span>
<span class="mi">5</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">98</span><span class="p">]</span>
</pre></div>


<p>このプログラムは、これまでと異なり、プランを左右逆に出力することにご注意ください。つまり、一番右がランクの上位・一番先に提案する海賊の分け前を表し、一番左が最後の海賊の分け前を表します。</p>
<p>結果、海賊が5人の場合の金貨の分配は、 <code>[1, 0, 1, 0, 98]</code> となり、先ほど頭の中で解いた結果と一致します。
ランク1位の提案者が金貨を98枚、3番目と5番目の海賊が金貨が1枚、それ以外は0枚で決定します。</p>
<hr />
<p>私: 「ダロ？一致しただろ？（ほっ）」</p>
<p>小学生A: 「ほんとだー。ちょっと信じてあげれるかもー。」</p>
<p>私: 「（ちょっとかよ...）」</p>
<p>小学生A: 「このプログラム間違ってないよね？だまそうとしてない？」</p>
<p>私: 「た、たぶん、あってると思うんだ..。」</p>
<p>小学生N: 「ねえねえ。じゃあ、逆の場合は？海賊100人で金貨5枚だとどうなるの？」</p>
<p>私: 「（おー良い質問ではないか。おぬし、きっと大物になりよるぞ。にやにや）試してみようか。」</p>
<div class="highlight"><pre><span class="c">% ./pirates.py 100 5</span>
 <span class="mi">1</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span>
 <span class="mi">2</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
 <span class="mi">3</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
 <span class="mi">4</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
 <span class="mi">5</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
 <span class="mi">6</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
 <span class="mi">7</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
 <span class="mi">8</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
 <span class="mi">9</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
 <span class="mi">10</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
 <span class="mi">11</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
 <span class="mi">12</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
 <span class="mi">13</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
 <span class="mi">14</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
 <span class="mi">15</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
 <span class="mi">16</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
 <span class="mi">17</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
 <span class="mi">18</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
 <span class="mi">19</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
 <span class="mi">20</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
 <span class="mi">21</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
 <span class="mi">22</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
 <span class="mi">23</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
 <span class="mi">24</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
 <span class="mi">25</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
 <span class="mi">26</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
 <span class="mi">27</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
 <span class="c">....</span>
 <span class="c">....</span>
 <span class="c">....</span>
</pre></div>


<p>私: 「...」</p>
<p>小学生A: 「...」</p>
<p>小学生N: 「...」</p>
<p>小学生A: 「遅いね...。」</p>
<p>小学生N: 「うん。」</p>
<p>小学生A: 「変なことしてパソコン壊したんじゃないの？」</p>
<p>私: 「いや、このプログラム、やっつけ仕事だったから、時間がかかるの（たらーん）。あ、<code>-1</code> はその海賊が殺されちゃうって意味だからね。」</p>
<p>小学生A: 「マイナス？」</p>
<p>私: 「（くっ...。）海賊が殺された時は、ばってん (<code>x</code>) にするね。結果を見やすくするために、ちょっと出力の仕方変更するね。ちょっと待ってて...。」</p>
<p>小学生N: 「うん。」</p>
<p>...</p>
<p>私: 「おっけー。海賊30人に減らして、もう一度やってみるね。」</p>
<div class="highlight"><pre><span class="c">% ./pirates.py 30 5</span>
 <span class="mi">1</span><span class="p">:</span> <span class="mi">5</span>
 <span class="mi">2</span><span class="p">:</span> <span class="mi">05</span>
 <span class="mi">3</span><span class="p">:</span> <span class="mi">104</span>
 <span class="mi">4</span><span class="p">:</span> <span class="mi">0104</span>
 <span class="mi">5</span><span class="p">:</span> <span class="mi">10103</span>
 <span class="mi">6</span><span class="p">:</span> <span class="mi">010103</span>
 <span class="mi">7</span><span class="p">:</span> <span class="mi">1010102</span>
 <span class="mi">8</span><span class="p">:</span> <span class="mi">01010102</span>
 <span class="mi">9</span><span class="p">:</span> <span class="mi">101010101</span>
<span class="mi">10</span><span class="p">:</span> <span class="mi">0101010101</span>
<span class="mi">11</span><span class="p">:</span> <span class="mi">10101010100</span>
<span class="mi">12</span><span class="p">:</span> <span class="mi">010101010100</span>
<span class="mi">13</span><span class="p">:</span> <span class="mi">010101010100</span><span class="n">x</span>
<span class="mi">14</span><span class="p">:</span> <span class="mi">10101010100000</span>
<span class="mi">15</span><span class="p">:</span> <span class="mi">10101010100000</span><span class="n">x</span>
<span class="mi">16</span><span class="p">:</span> <span class="mi">10101010100000</span><span class="n">xx</span>
<span class="mi">17</span><span class="p">:</span> <span class="mi">10101010100000</span><span class="n">xxx</span>
<span class="mi">18</span><span class="p">:</span> <span class="mi">010101010100000000</span>
<span class="mi">19</span><span class="p">:</span> <span class="mi">010101010100000000</span><span class="n">x</span>
<span class="mi">20</span><span class="p">:</span> <span class="mi">010101010100000000</span><span class="n">xx</span>
<span class="mi">21</span><span class="p">:</span> <span class="mi">010101010100000000</span><span class="n">xxx</span>
<span class="mi">22</span><span class="p">:</span> <span class="mi">010101010100000000</span><span class="n">xxxx</span>
<span class="mi">23</span><span class="p">:</span> <span class="mi">010101010100000000</span><span class="n">xxxxx</span>
<span class="mi">24</span><span class="p">:</span> <span class="mi">010101010100000000</span><span class="n">xxxxxx</span>
<span class="mi">25</span><span class="p">:</span> <span class="mi">010101010100000000</span><span class="n">xxxxxxx</span>
<span class="mi">26</span><span class="p">:</span> <span class="mi">10101010100000000000000000</span>
<span class="mi">27</span><span class="p">:</span> <span class="mi">10101010100000000000000000</span><span class="n">x</span>
<span class="mi">28</span><span class="p">:</span> <span class="mi">10101010100000000000000000</span><span class="n">xx</span>
<span class="mi">29</span><span class="p">:</span> <span class="mi">10101010100000000000000000</span><span class="n">xxx</span>
<span class="mi">30</span><span class="p">:</span> <span class="mi">10101010100000000000000000</span><span class="n">xxxx</span>
</pre></div>


<p>小学生N: 「海賊が30人のときは、４人死んじゃうの？」</p>
<p>私: 「そうだね。最初の4人はどんなにがんばっても半数以上の賛成を得られるプランがつくれないんだね。」</p>
<p>小学生N: 「かわいそう。」</p>
<p>私: 「例えば、30人のときは賛成票を自分以外で14票とらないといけないんだけど、29人残った時のブランはえーと...」</p>
<div class="highlight"><pre><span class="mi">29</span><span class="o">:</span> <span class="mi">10101010100000000000000000</span><span class="n">xxx</span>
</pre></div>


<p>私: 「...こうであることがわかっているので、どんなにうまく5枚の金貨を配分しても、14票集めることができないんだね。例えば、金貨の配分を」</p>
<div class="highlight"><pre><span class="m">29</span><span class="o">:</span> <span class="m">10101010100000000000000000</span>xxx
    <span class="m">01010101010000000000000000000</span> <span class="p">(</span><span class="o">&lt;-</span> 金貨の配分<span class="p">)</span>
</pre></div>


<p>私: 「...としても、賛成してくれる人は、8人しかいないので、殺されちゃうんだなー。かわいそうだね。」</p>
<p>小学生N: 「社会きびしいね。」</p>
<p>私: 「（お、おう）... しかし、これ面白いな..。なるほど。」</p>
<p>小学生A: 「(突然) え、面白い？なになに？」</p>
<p>私: 「（きみ今アイカツ見てただろ...）いあ、パターンがあって...。いや何でもないです。これ、一般解 <sup id="fnref:2"><a class="footnote-ref" href="#fn:2" rel="footnote">2</a></sup> とか求められそうだな。うん。」</p>
<p>小学生A: 「パソコンってもっと早いのかと思ったけど、遅いんだー。海賊100人で金貨1万枚を奪い合う戦いを見たかったなー。」</p>
<p>私: 「（アイカツでも見てなさい...）ごめんなさい。パソコンは悪くない、僕が悪いんです...。早くしようと思えばできるんだけど...。」</p>
<p>小学生N: 「早くできるの？私もみてみたいなー。」</p>
<p>私: 「うん、プランを全通り生成しているところはもっと早くできるよ <sup id="fnref:3"><a class="footnote-ref" href="#fn:3" rel="footnote">3</a></sup>。でも、それよりはちゃんと論理的に解くのが一番だと思う。ちょっと待っててね。」</p>
<hr />
<p>先ほど頭の中で解いた方法を今度はプログラムで再現してみましょう。以下のようになります。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#!/usr/bin/env python3</span>

<span class="kn">import</span> <span class="nn">sys</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">num_pirates</span><span class="p">,</span> <span class="n">coin</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="n">proposal</span><span class="p">):</span>
        <span class="n">necessary_vote</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">proposal</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">ranks</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">proposal</span><span class="p">))</span>
        <span class="n">necessary_coin</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">ranks</span><span class="p">[:</span><span class="n">necessary_vote</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">coin</span> <span class="o">&gt;=</span> <span class="n">necessary_coin</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">ranks</span><span class="o">.</span><span class="n">index</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">necessary_vote</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">proposal</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">coin</span> <span class="o">-</span> <span class="n">necessary_coin</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">proposal</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">pretty</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&#39;x&#39;</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&#39;G&#39;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="n">optimal_proposal</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_pirates</span><span class="p">):</span>
        <span class="n">optimal_proposal</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">optimal_proposal</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s">&#39;{:4}: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">member</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                                <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pretty</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">optimal_proposal</span><span class="p">)))</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</td></tr></table>

<p>こちらだと、海賊100人、金貨1万枚の場合も時間をかけないで解くことが可能です。</p>
<p>例として、海賊100人、金貨20枚の場合の結果は以下のようになります。
（見やすくするため、金貨が10枚以上のときは <code>G</code> にしています。）</p>
<div class="highlight"><pre>  <span class="mi">1</span><span class="o">:</span> <span class="n">G</span>
  <span class="mi">2</span><span class="o">:</span> <span class="mi">0</span><span class="n">G</span>
  <span class="mi">3</span><span class="o">:</span> <span class="mi">10</span><span class="n">G</span>
  <span class="mi">4</span><span class="o">:</span> <span class="mo">010</span><span class="n">G</span>
  <span class="mi">5</span><span class="o">:</span> <span class="mi">1010</span><span class="n">G</span>
  <span class="mi">6</span><span class="o">:</span> <span class="mo">01010</span><span class="n">G</span>
  <span class="mi">7</span><span class="o">:</span> <span class="mi">101010</span><span class="n">G</span>
  <span class="mi">8</span><span class="o">:</span> <span class="mo">0101010</span><span class="n">G</span>
  <span class="mi">9</span><span class="o">:</span> <span class="mi">10101010</span><span class="n">G</span>
 <span class="mi">10</span><span class="o">:</span> <span class="mo">010101010</span><span class="n">G</span>
 <span class="mi">11</span><span class="o">:</span> <span class="mi">1010101010</span><span class="n">G</span>
 <span class="mi">12</span><span class="o">:</span> <span class="mo">01010101010</span><span class="n">G</span>
 <span class="mi">13</span><span class="o">:</span> <span class="mi">101010101010</span><span class="n">G</span>
 <span class="mi">14</span><span class="o">:</span> <span class="mo">0101010101010</span><span class="n">G</span>
 <span class="mi">15</span><span class="o">:</span> <span class="mi">10101010101010</span><span class="n">G</span>
 <span class="mi">16</span><span class="o">:</span> <span class="mo">010101010101010</span><span class="n">G</span>
 <span class="mi">17</span><span class="o">:</span> <span class="mi">1010101010101010</span><span class="n">G</span>
 <span class="mi">18</span><span class="o">:</span> <span class="mo">01010101010101010</span><span class="n">G</span>
 <span class="mi">19</span><span class="o">:</span> <span class="mi">101010101010101010</span><span class="n">G</span>
 <span class="mi">20</span><span class="o">:</span> <span class="mo">0101010101010101010</span><span class="n">G</span>
 <span class="mi">21</span><span class="o">:</span> <span class="mi">10101010101010101010</span><span class="n">G</span>
 <span class="mi">22</span><span class="o">:</span> <span class="mo">010101010101010101010</span><span class="n">G</span>
 <span class="mi">23</span><span class="o">:</span> <span class="mi">10101010101010101010109</span>
 <span class="mi">24</span><span class="o">:</span> <span class="mo">01010101010101010101010</span><span class="mi">9</span>
 <span class="mi">25</span><span class="o">:</span> <span class="mi">1010101010101010101010108</span>
 <span class="mi">26</span><span class="o">:</span> <span class="mo">0101010101010101010101010</span><span class="mi">8</span>
 <span class="mi">27</span><span class="o">:</span> <span class="mi">101010101010101010101010107</span>
 <span class="mi">28</span><span class="o">:</span> <span class="mo">0101010101010101010101010107</span>
 <span class="mi">29</span><span class="o">:</span> <span class="mi">10101010101010101010101010106</span>
 <span class="mi">30</span><span class="o">:</span> <span class="mo">010101010101010101010101010106</span>
 <span class="mi">31</span><span class="o">:</span> <span class="mi">1010101010101010101010101010105</span>
 <span class="mi">32</span><span class="o">:</span> <span class="mo">01010101010101010101010101010105</span>
 <span class="mi">33</span><span class="o">:</span> <span class="mi">101010101010101010101010101010104</span>
 <span class="mi">34</span><span class="o">:</span> <span class="mo">0101010101010101010101010101010104</span>
 <span class="mi">35</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010103</span>
 <span class="mi">36</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010103</span>
 <span class="mi">37</span><span class="o">:</span> <span class="mi">1010101010101010101010101010101010102</span>
 <span class="mi">38</span><span class="o">:</span> <span class="mo">01010101010101010101010101010101010102</span>
 <span class="mi">39</span><span class="o">:</span> <span class="mi">101010101010101010101010101010101010101</span>
 <span class="mi">40</span><span class="o">:</span> <span class="mo">0101010101010101010101010101010101010101</span>
 <span class="mi">41</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010101010100</span>
 <span class="mi">42</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100</span>
 <span class="mi">43</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100</span><span class="n">x</span>
 <span class="mi">44</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010101010100000</span>
 <span class="mi">45</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010101010100000</span><span class="n">x</span>
 <span class="mi">46</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010101010100000</span><span class="n">xx</span>
 <span class="mi">47</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010101010100000</span><span class="n">xxx</span>
 <span class="mi">48</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000</span>
 <span class="mi">49</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000</span><span class="n">x</span>
 <span class="mi">50</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000</span><span class="n">xx</span>
 <span class="mi">51</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000</span><span class="n">xxx</span>
 <span class="mi">52</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000</span><span class="n">xxxx</span>
 <span class="mi">53</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000</span><span class="n">xxxxx</span>
 <span class="mi">54</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000</span><span class="n">xxxxxx</span>
 <span class="mi">55</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000</span><span class="n">xxxxxxx</span>
 <span class="mi">56</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010101010100000000000000000</span>
 <span class="mi">57</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010101010100000000000000000</span><span class="n">x</span>
 <span class="mi">58</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010101010100000000000000000</span><span class="n">xx</span>
 <span class="mi">59</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010101010100000000000000000</span><span class="n">xxx</span>
 <span class="mi">60</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010101010100000000000000000</span><span class="n">xxxx</span>
 <span class="mi">61</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010101010100000000000000000</span><span class="n">xxxxx</span>
 <span class="mi">62</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010101010100000000000000000</span><span class="n">xxxxxx</span>
 <span class="mi">63</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010101010100000000000000000</span><span class="n">xxxxxxx</span>
 <span class="mi">64</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010101010100000000000000000</span><span class="n">xxxxxxxx</span>
 <span class="mi">65</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010101010100000000000000000</span><span class="n">xxxxxxxxx</span>
 <span class="mi">66</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010101010100000000000000000</span><span class="n">xxxxxxxxxx</span>
 <span class="mi">67</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010101010100000000000000000</span><span class="n">xxxxxxxxxxx</span>
 <span class="mi">68</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010101010100000000000000000</span><span class="n">xxxxxxxxxxxx</span>
 <span class="mi">69</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010101010100000000000000000</span><span class="n">xxxxxxxxxxxxx</span>
 <span class="mi">70</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010101010100000000000000000</span><span class="n">xxxxxxxxxxxxxx</span>
 <span class="mi">71</span><span class="o">:</span> <span class="mi">10101010101010101010101010101010101010100000000000000000</span><span class="n">xxxxxxxxxxxxxxx</span>
 <span class="mi">72</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span>
 <span class="mi">73</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">x</span>
 <span class="mi">74</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xx</span>
 <span class="mi">75</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxx</span>
 <span class="mi">76</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxx</span>
 <span class="mi">77</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxx</span>
 <span class="mi">78</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxx</span>
 <span class="mi">79</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxx</span>
 <span class="mi">80</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxxx</span>
 <span class="mi">81</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxxxx</span>
 <span class="mi">82</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxxxxx</span>
 <span class="mi">83</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxxxxxx</span>
 <span class="mi">84</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxxxxxxx</span>
 <span class="mi">85</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxxxxxxxx</span>
 <span class="mi">86</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxxxxxxxxx</span>
 <span class="mi">87</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxxxxxxxxxx</span>
 <span class="mi">88</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxxxxxxxxxxx</span>
 <span class="mi">89</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxxxxxxxxxxxx</span>
 <span class="mi">90</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxxxxxxxxxxxxx</span>
 <span class="mi">91</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxxxxxxxxxxxxxx</span>
 <span class="mi">92</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxxxxxxxxxxxxxxx</span>
 <span class="mi">93</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxxxxxxxxxxxxxxxx</span>
 <span class="mi">94</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxxxxxxxxxxxxxxxxx</span>
 <span class="mi">95</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxxxxxxxxxxxxxxxxxx</span>
 <span class="mi">96</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxxxxxxxxxxxxxxxxxxx</span>
 <span class="mi">97</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxxxxxxxxxxxxxxxxxxxx</span>
 <span class="mi">98</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxxxxxxxxxxxxxxxxxxxxx</span>
 <span class="mi">99</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxxxxxxxxxxxxxxxxxxxxxx</span>
<span class="mi">100</span><span class="o">:</span> <span class="mo">010101010101010101010101010101010101010100000000000000000000000000000000</span><span class="n">xxxxxxxxxxxxxxxxxxxxxxxxxxxx</span>
</pre></div>


<hr />
<p>小学生A: 「海賊がいっぱいいて、金貨の枚数がちょっとだったら、人がいっぱい死んじゃうだね。納得。」</p>
<p>私: 「（納得していいのか...) 試しに両方のプログラムの結果を比較してみるとだ...。うん、同じだな。」</p>
<p>小学生N: 「どういうこと？」</p>
<p>私: 「最初に紙と鉛筆で説明したでしょ。あの考え方間違ってなかったってことかな？」</p>
<p>小学生N: 「うん。不思議だったけどあっていたんだね。」</p>
<p>私: 「うん。よかった（ほっ）」</p>
<p>小学生A: 「なんだ、やっぱり自信なかったんだ。」</p>
<p>私: 「（くっ。）」</p>
<p>...</p>
<p>(小学生A と 小学生N、何やら2人で相談しはじめる)</p>
<p>...</p>
<p>小学生A: 「...ところで。」</p>
<p>私: 「なに？」</p>
<p>小学生A: 「お年玉は何枚くれるの？」</p>
<p>小学生N: 「枚数が少なかったら反対しちゃうぞ♡」</p>
<p>私: 「(ちょ。ぼく、ころさないでよ) ... 」</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>海賊3人の場合は、<code>Combination(102, 2) = 5,151</code> 通りです。4人の場合は、<code>Combination(103, 3) = 176,851</code> 通り、5人の場合は、<code>Combination(104, 4) = 4,598,126</code> 通りです。&#160;<a class="footnote-backref" href="#fnref:1" rev="footnote" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>海賊の人数を <code>n</code>, 自分のランクを <code>i</code>, 金貨の枚数を <code>c</code> とした場合、得られる金貨の枚数の一般解 <code>f(n, i, c)</code> を式で表すことが可能です。&#160;<a class="footnote-backref" href="#fnref:2" rev="footnote" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p><a href="http://en.wikipedia.org/wiki/Branch_and_bound">Branch and bound</a> すること（枝刈り) で大幅に生成されるプランの数を減らすことが可能です。&#160;<a class="footnote-backref" href="#fnref:3" rev="footnote" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
</ol>
</div>
  </div>
</article>
<div class="social text-right">
  <a href="https://twitter.com/share" class="twitter-share-button"
 data-text="Googleの面接試験で出る （はずがない）「海賊と金貨」問題を空気を読まないでプログラムで解いてみる"  data-url="http://hayato.io/2014/pirates/"  data-language="en"    data-dnt="true">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="g-plusone" data-size="medium" data-annotation="inline" data-href="http://hayato.io/2014/pirates/"></div>

  <script type="text/javascript">
  window.___gcfg = {lang: "en"};
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>

</div>

<ul class="pager">
        <li class="previous"><a href="http://hayato.io/2014/timer/" rel="prev">&larr; Newer Post</a></li>
        <li class="next"><a href="http://hayato.io/2014/hayato.io/" rel="next">Older Post &rarr;</a></li>
</ul>


          <hr/>
          <footer class="base-footer text-center">
            <small>
              Contents licensed under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.
            </small>
          </footer>
        </div>
      </div>
    </div>
    <script src="//code.jquery.com/jquery.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>
    <script src="http://hayato.io/theme/site.js"></script>
  </body>
</html>